<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js'></script>
    <script src='https://npmcdn.com/@turf/turf@3.5.1/turf.min.js'></script>
    <link href='https://www.mapbox.com/base/latest/base.css' rel='stylesheet' />

    <title>Test Page for HomeSafe JavaScript</title>

    <script>
        var mortality = {1:0.000006133333,
                        2:0.0007031099,
                        3:0.0050465876,
                        4:0.0342701136,
                        5:0.0251089529
        };

        //Returns the body counts from a list of populations, given the category of hurricane on top of them.
        function deathsLists(populations,cat) {
            var total = 0;
            for(var i=0;i<populations.length;i++) {
                total+=deaths(populations[i],cat);
            }
            return total;
        }

        //Returns the body count from a population, given the category of hurricane on top of it.
        function deaths(population, cat) {
            return population*mortality[cat];
        }

        //Returns the total body count
        function bodyCount(counties,hurricane,category) {
            var totalPop = 0;
            for(vari=0;i<counties.length;i++) {
                if(turf.intersect(counties[i], hurricane)!=null) {
                    //TODO: fix this
                    totalPop+=counties[i].population;
                }
            }
            return deaths(totalPop, category);
        }


        //Static test stuff
        for(var num =1;num<6;num++) {
            console.log(deaths(1000,num));
        }

    </script>
</head>
<body>
<div id='map'></div>

<script>
    L.mapbox.accessToken = 'pk.eyJ1IjoibW9yZ2FuaGVybG9ja2VyIiwiYSI6Ii1zLU4xOWMifQ.FubD68OEerk74AYCLduMZQ';

    var polygon1 = turf.polygon([
        [
            [-97.42675781249999, 33.82023008524739], [-97.2125244140625, 33.89321737944089 ],
            [-97.086181640625, 33.706062655101206], [-96.94335937499999, 33.920571528675104],
            [-96.295166015625, 33.696922692957685], [-96.1029052734375, 33.83848275599514],
            [-95.7843017578125, 33.8521697014074], [-95.5810546875, 33.925129700072],
            [-95.3887939453125, 33.87041555094183], [-95.20751953125, 33.95247360616282],
            [-94.493408203125, 33.64663552343713], [-94.43161010742188, 35.39576704533903],
            [-94.61700439453125, 36.49418152677429], [-94.6142578125, 37.01132594307015],
            [-102.996826171875, 37.00693943418586], [-103.0078125, 36.49638952000399],
            [-100.008544921875, 36.48755716938579], [-100.008544921875, 34.57442951865274],
            [-99.931640625, 34.57442951865274], [-99.66796875, 34.36611072883117],
            [-99.591064453125, 34.3751788753353], [-99.5635986328125, 34.42503613021334],
            [-99.4097900390625, 34.36611072883117], [-99.39880371093749, 34.447688696497444],
            [-99.327392578125, 34.447688696497444], [-99.195556640625, 34.32529192442733],
            [-99.195556640625, 34.243594729697406], [-99.1461181640625, 34.21634468843465],
            [-98.96484375, 34.22088697429016], [-98.7451171875, 34.14363482031264],
            [-98.54187011718749, 34.13454168193739], [-98.514404296875, 34.07086232376631],
            [-98.349609375, 34.161818161230386], [-98.1024169921875, 34.13908837343849],
            [-98.118896484375, 33.99802726234877], [-97.9595947265625, 34.00713506435885],
            [-97.96508789062499, 33.87953701355924], [-97.767333984375, 33.897777013859475],
            [-97.646484375, 33.97980872872457], [-97.42675781249999, 33.82023008524739]
        ]
    ], {
        "fill": "#6BC65F",
        "stroke": "#6BC65F",
        "stroke-width": 5
    });

    var polygon2 = turf.polygon([
        [
            [-109.05029296875, 57.00255267215955],[-102.9638671875, 57.020098201368114],
            [-97.1630859375,56.77409249464195],
            [-103.0078125, 56.54494944148322],[-103.095703125, 52.045332838858506],
            [-106.5673828125, 51.989441837922904], [-106.5673828125, 51.784216884487385],
            [-108.2373046875, 51.765537409484374],[-108.28125, 51.39115752282472],
            [-109.09423828125, 51.372399104880525],[-109.05029296875, 57.00255267215955]
        ]
    ], {
        "fill": "#6BC65F",
        "stroke": "#6BC65F",
        "stroke-width": 5
    });

    var aIntersect = turf.intersect(polygon1, polygon2);
    if(aIntersect==null)
            console.log("No intersect");



    var map = L.mapbox.map('map', 'morganherlocker.kgidd73k')
            .setView([35.463453, -100.514914], 5);

    L.mapbox.featureLayer().setGeoJSON(polygon1).addTo(map);
    L.mapbox.featureLayer().setGeoJSON(polygon2).addTo(map);

    //L.mapbox.featureLayer().setGeoJSON(polygon).addTo(map);

</script>

</body>
</html>